<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Inscription - Aurum</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="assets/css/styles.css" />
  
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  
  <script src="assets/js/auth.js"></script>
  <script src="assets/js/app.js"></script>
</head>

<body>
  <header id="app-header" class="header">
      <div class="container navbar">
                <a href="index.html" class="brand">
                    <div class="brand-logo-img" style="width:44px; height:44px; border-radius:12px; background:var(--gold); display:flex; align-items:center; justify-content:center; color:black; font-weight:800;">A</div>
                    <div style="display:flex; flex-direction:column; margin-left:10px;">
                        <span class="brand-name" style="font-size:22px; font-weight:800; letter-spacing:0.5px;">AURUM</span>
                        <span class="tagline" style="font-size:11px; letter-spacing:1px; color:#666;">EXCELLENCE À VOTRE PORTÉE</span>
                    </div>
                </a>
          <nav class="nav-actions">
              <a href="catalogue.html" class="icon-btn"><i data-lucide="search"></i></a>
              <a href="cart.html" class="icon-btn" style="position:relative;">
                  <i data-lucide="shopping-bag"></i>
                  <span class="badge" id="cart-badge" style="display:none; position:absolute; top:-5px; right:-5px; background:red; color:white; font-size:10px; padding:2px 5px; border-radius:50%;">0</span>
              </a>              <a href="wishlist.html" class="icon-btn"><i data-lucide="heart"></i></a>              <button class="menu-toggle" id="menu-toggle" style="z-index: 1001;"><i data-lucide="menu"></i></button>
          </nav>
      </div>
  </header>

  <div class="mobile-drawer" id="mobile-drawer">
      <div class="drawer-header">
          <span class="drawer-title">Menu</span>
          <button class="close-btn" id="close-btn"><i data-lucide="x"></i></button>
      </div>
      <nav class="drawer-nav">
          <a href="index.html" class="drawer-link"><i data-lucide="home"></i> Accueil</a>
          <a href="catalogue.html" class="drawer-link"><i data-lucide="grid"></i> Catalogue</a>
          <a href="cart.html" class="drawer-link"><i data-lucide="shopping-bag"></i> Panier</a>
          <a href="wishlist.html" class="drawer-link"><i data-lucide="heart"></i> Mes Favoris</a>
          <a href="boutique-list.html" class="drawer-link"><i data-lucide="store"></i> Nos Boutiques</a>
          <div class="drawer-divider"></div>
          <a href="seller.html" class="drawer-link"><i data-lucide="store"></i> Espace Vendeur</a>
          <a href="profile.html" class="drawer-link"><i data-lucide="user"></i> Mon Profil</a>
          <div class="drawer-divider"></div>
          <a href="#" id="mobile-logout-btn" class="drawer-link" style="color: #ef4444;">
              <i data-lucide="log-out"></i> Déconnexion
          </a>
      </nav>
  </div>
  <div id="menu-overlay"></div>

    <main class="container">
        <section class="section">
            <div style="max-width: 400px; margin: 0 auto;">
                <h1>Créer un compte</h1>
                
                <div id="register-container" class="grid grid-1" style="gap: 15px;">
                    
                    <div class="form-group">
                        <label style="font-weight: bold;">Nom complet</label>
                        <input type="text" id="reg-name" class="input" placeholder="Votre nom">
                    </div>

                    <div class="form-group">
                        <label style="font-weight: bold;">Email</label>
                        <input type="email" id="reg-email" class="input" placeholder="exemple@gmail.com">
                    </div>

                    <div class="form-group">
                        <label style="font-weight: bold;">Mot de passe</label>
                        <input type="password" id="reg-pass" class="input" placeholder="6 caractères minimum">
                    </div>

                    <div class="form-group">
                        <label style="font-weight: bold;">Confirmer le mot de passe</label>
                        <input type="password" id="reg-pass-confirm" class="input" placeholder="Répétez le mot de passe">
                    </div>

                    <button type="button" id="btn-register" class="btn btn-gold" style="width: 100%; padding: 15px; margin-top: 10px;">
                        S'inscrire
                    </button>

                </div>
                
                <p style="margin-top: 20px; text-align: center;">
                    Déjà un compte ? <a href="login.html" style="color: var(--gold); font-weight: bold;">Se connecter</a>
                </p>

                <div id="error-message" style="color: red; text-align: center; margin-top: 10px; font-weight: bold;"></div>
            </div>
        </section>
    </main>

  <div class="toast-container" id="toast-container"></div>

  <script src="assets/js/app.js"></script>
  <script>
    // === PAGE REGISTER - LOGIQUE SPÉCIFIQUE ===
    document.addEventListener('DOMContentLoaded', () => {
        const yearSpan = document.getElementById('year');
        if (yearSpan) yearSpan.innerText = new Date().getFullYear();

        // LOGIQUE D'INSCRIPTION (CODE SPÉCIFIQUE)
        const auth = firebase.auth();
        const db = firebase.firestore();
        const btn = document.getElementById('btn-register');
        const errorDiv = document.getElementById('error-message');

        if(btn) {
            btn.addEventListener('click', function() {
                const name = document.getElementById('reg-name').value;
                const email = document.getElementById('reg-email').value;
                const pass = document.getElementById('reg-pass').value;
                const passConfirm = document.getElementById('reg-pass-confirm').value;

                if(!name || !email || !pass) {
                    alert("Veuillez remplir tous les champs.");
                    return;
                }
                if(pass !== passConfirm) {
                    alert("Les mots de passe ne correspondent pas !");
                    return;
                }
                if(pass.length < 6) {
                    alert("Le mot de passe doit faire au moins 6 caractères.");
                    return;
                }

                btn.innerText = "Création en cours...";
                btn.disabled = true;
                errorDiv.innerText = "";

                auth.createUserWithEmailAndPassword(email, pass)
                    .then((userCredential) => {
                        const user = userCredential.user;
                        
                        return user.updateProfile({
                            displayName: name
                        }).then(() => {
                            // Créer le document dans la collection users
                            return db.collection('users').doc(user.uid).set({
                                name: name,
                                email: email,
                                role: 'client',
                                createdAt: new Date()
                            });
                        }).then(() => {
                            alert("✅ Compte crée avec succès !");
                            window.location.href = "index.html";
                        });
                    })
                    .catch((error) => {
                        console.error(error);
                        let msg = "Erreur: " + error.code;
                        if (error.code === 'auth/email-already-in-use') msg = "Cet email est déjà utilisé.";
                        if (error.code === 'auth/invalid-email') msg = "Email invalide.";
                        
                        alert("⚠️ " + msg);
                        errorDiv.innerText = msg;
                        
                        btn.innerText = "S'inscrire";
                        btn.disabled = false;
                    });
            });
        }
        
        if(typeof lucide !== 'undefined') lucide.createIcons();
    });
  </script>
  <script src="assets/js/footer.js" defer></script>
</body>
</html>
